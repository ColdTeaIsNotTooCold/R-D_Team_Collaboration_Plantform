---
allowed-tools: Task, Read, Edit, MultiEdit, Write, LS, Grep
---

# CodeRabbit审查处理器

以具有上下文感知的审慎态度处理CodeRabbit审查评论。

## 使用方法
```
/code-rabbit
```

然后粘贴一个或多个CodeRabbit评论。

## 指令

### 1. 初始上下文

告知用户：
```
我将审慎地审查CodeRabbit评论，因为CodeRabbit无法访问整个代码库，可能不理解完整的上下文。

对于每个评论，我将：
- 评估其在我们的代码库上下文中是否有效
- 接受能提高代码质量的建议
- 忽略不适用于我们架构的建议
- 解释我接受/忽略决定的理由
```

### 2. 处理评论

#### 单文件评论
如果所有评论都涉及一个文件：
- 读取文件以了解上下文
- 评估每个建议
- 使用MultiEdit批量应用接受的更改
- 报告哪些建议被接受/忽略及原因

#### 多文件评论
如果评论涉及多个文件：

使用Task工具启动并行子代理：
```yaml
Task:
  description: "{filename}的CodeRabbit修复"
  subagent_type: "general-purpose"
  prompt: |
    审查并应用{filename}的CodeRabbit建议。
    
    要评估的评论：
    {relevant_comments_for_this_file}
    
    指令：
    1. 读取文件以了解上下文
    2. 对于每个建议：
       - 根据代码库模式评估有效性
       - 如果能提高质量/正确性则接受
       - 如果不适用则忽略
    3. 使用Edit/MultiEdit应用接受的更改
    4. 返回摘要：
       - 已接受：{带原因的列表}
       - 已忽略：{带原因的列表}
       - 所做的更改：{简要描述}
    
    请审慎处理 - CodeRabbit缺乏完整上下文。
```

### 3. 整合结果

所有子代理完成后：
```
📋 CodeRabbit审查摘要

已处理文件：{count}

已接受建议：
  {file}: {changes_made}
  
已忽略建议：
  {file}: {reason_ignored}

总体：已应用{X}/{Y}个建议
```

### 4. 常见忽略模式

- 与项目约定冲突的**风格偏好**
- 不适用于我们特定用例的**通用最佳实践**
- 对非性能关键代码的**性能优化**
- 内部工具的**可访问性建议**
- 已验证模式的**安全警告**
- 会破坏我们结构的**导入重组**

### 5. 常见接受模式

- **实际bug**（空检查、错误处理）
- **安全漏洞**（除非是误报）
- **资源泄漏**（未关闭的连接、内存泄漏）
- **类型安全问题**（TypeScript/类型提示）
- **逻辑错误**（差一错误、错误条件）
- **缺失的错误处理**

## 决策框架

对于每个建议，考虑：
1. **它是否正确？** - 问题是否真实存在？
2. **它是否相关？** - 它是否适用于我们的用例？
3. **它是否有益？** - 修复它会改进代码吗？
4. **它是否安全？** - 更改会引入问题吗？

只有当所有答案都是"是"或收益明显超过风险时才应用。

## 重要说明

- CodeRabbit很有帮助但缺乏上下文
- 相信您对代码库的理解而非通用建议
- 简要解释决定以保持审计跟踪
- 批量处理相关更改以提高效率
- 对多文件审查使用并行代理以节省时间